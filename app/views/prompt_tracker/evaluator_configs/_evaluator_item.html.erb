<%# Evaluator item card for test form %>
<%# Locals: state (EvaluatorItemState), testable %>

<div class="col-lg-6 col-xl-4 mb-3">
  <div class="<%= evaluator_card_classes(state) %>" data-evaluator-key="<%= state.key %>">
    <div class="card-body p-3">
      <div class="form-check mb-2">
        <input class="form-check-input"
               type="checkbox"
               id="evaluator_<%= state.key %>"
               data-evaluator-key="<%= state.key %>"
               data-evaluator-configs-target="checkbox"
               data-action="change->evaluator-configs#toggleConfig"
               <%= 'checked' if state.selected %>
               <%= 'disabled' if state.disabled %>>
        <label class="form-check-label w-100" for="evaluator_<%= state.key %>">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <strong><i class="bi bi-<%= state.meta[:icon] %>"></i> <%= state.meta[:name] %></strong>
              <br>
              <small class="text-muted"><%= state.meta[:description] %></small>
              <% if state.disabled %>
                <br><small class="text-warning"><i class="bi bi-exclamation-triangle"></i> <%= state.disabled_reason %></small>
              <% end %>
            </div>
          </div>
        </label>
      </div>

      <div class="<%= 'collapse' unless state.selected %>"
           id="config_<%= state.key %>"
           data-evaluator-configs-target="config">
        <hr class="my-2">
        <div class="mt-2">
          <label class="form-label small mb-1">Configuration</label>
          <div data-evaluator-key="<%= state.key %>"
               data-evaluator-configs-target="configFormContainer">
            <%= render partial: "prompt_tracker/evaluator_configs/forms/#{state.key}",
                       locals: { existing_config: state.existing_config, evaluator_key: state.key, testable: testable } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

